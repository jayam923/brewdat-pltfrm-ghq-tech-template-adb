
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Welcome to brewdat-pltfrm-ghq-tech-template-adb’s documentation! &#8212; brewdat-pltfrm-ghq-tech-template-adb  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-brewdat.data_engineering.utils">
<span id="welcome-to-brewdat-pltfrm-ghq-tech-template-adb-s-documentation"></span><h1>Welcome to brewdat-pltfrm-ghq-tech-template-adb’s documentation!<a class="headerlink" href="#module-brewdat.data_engineering.utils" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">brewdat.data_engineering.utils.</span></span><span class="sig-name descname"><span class="pre">BrewDatLibrary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spark</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pyspark.sql.session.SparkSession</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dbutils</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary" title="Permalink to this definition">¶</a></dt>
<dd><p>Reusable functions for all BrewDat projects.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.spark">
<span class="sig-name descname"><span class="pre">spark</span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.spark" title="Permalink to this definition">¶</a></dt>
<dd><p>A Spark session.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>SparkSession</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.dbutils">
<span class="sig-name descname"><span class="pre">dbutils</span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.dbutils" title="Permalink to this definition">¶</a></dt>
<dd><p>A Databricks utils object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.LoadType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LoadType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.LoadType" title="Permalink to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.LoadType.APPEND_ALL">
<span class="sig-name descname"><span class="pre">APPEND_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'APPEND_ALL'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.LoadType.APPEND_ALL" title="Permalink to this definition">¶</a></dt>
<dd><p>Load type where all records in the df are written into an table.</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p><strong>ATTENTION</strong>: use this load type only for Bronze tables, as it is bad for backfilling.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.LoadType.APPEND_NEW">
<span class="sig-name descname"><span class="pre">APPEND_NEW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'APPEND_NEW'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.LoadType.APPEND_NEW" title="Permalink to this definition">¶</a></dt>
<dd><p>Load type where only new records in the df are written into an existing table.
Records for which the key already exists in the table are ignored.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.LoadType.OVERWRITE_PARTITION">
<span class="sig-name descname"><span class="pre">OVERWRITE_PARTITION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'OVERWRITE_PARTITION'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.LoadType.OVERWRITE_PARTITION" title="Permalink to this definition">¶</a></dt>
<dd><p>Load type for overwriting a single partition based on partitionColumns.
This deletes records that are not present in df for the chosen partition.
The df must be filtered such that it contains a single partition.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.LoadType.OVERWRITE_TABLE">
<span class="sig-name descname"><span class="pre">OVERWRITE_TABLE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'OVERWRITE_TABLE'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.LoadType.OVERWRITE_TABLE" title="Permalink to this definition">¶</a></dt>
<dd><p>Load type where the entire table is rewritten in every execution.
Avoid whenever possible, as this is not good for large tables.
This deletes records that are not present in df.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.LoadType.TYPE_2_SCD">
<span class="sig-name descname"><span class="pre">TYPE_2_SCD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'TYPE_2_SCD'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.LoadType.TYPE_2_SCD" title="Permalink to this definition">¶</a></dt>
<dd><p>Load type that implements the standard type-2 Slowly Changing Dimension implementation.
This essentially uses an upsert that keeps track of all previous versions of each record.
For more information: <a class="reference external" href="https://en.wikipedia.org/wiki/Slowly_changing_dimension">https://en.wikipedia.org/wiki/Slowly_changing_dimension</a> .</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p><strong>ATTENTION</strong>: This load type is not implemented on this library yet!</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.LoadType.UPSERT">
<span class="sig-name descname"><span class="pre">UPSERT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'UPSERT'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.LoadType.UPSERT" title="Permalink to this definition">¶</a></dt>
<dd><p>Load type where records of a df are appended as new records or update existing records based on the key.
This does NOT delete existing records that are not included in df.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RawFileFormat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat.CSV">
<span class="sig-name descname"><span class="pre">CSV</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'CSV'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat.CSV" title="Permalink to this definition">¶</a></dt>
<dd><p>CSV format.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat.DELTA">
<span class="sig-name descname"><span class="pre">DELTA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'DELTA'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat.DELTA" title="Permalink to this definition">¶</a></dt>
<dd><p>Delta Lake format.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat.ORC">
<span class="sig-name descname"><span class="pre">ORC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ORC'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat.ORC" title="Permalink to this definition">¶</a></dt>
<dd><p>ORC format.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat.PARQUET">
<span class="sig-name descname"><span class="pre">PARQUET</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'PARQUET'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat.PARQUET" title="Permalink to this definition">¶</a></dt>
<dd><p>Parquet format.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ReturnObject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject" title="Permalink to this definition">¶</a></dt>
<dd><p>Object that holds metadata from a data write operation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.status">
<span class="sig-name descname"><span class="pre">status</span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Resulting status for this write operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.target_object">
<span class="sig-name descname"><span class="pre">target_object</span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.target_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Target object that we intended to write to.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.num_records_read">
<span class="sig-name descname"><span class="pre">num_records_read</span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.num_records_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of records read from the DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int, default=0</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.num_records_loaded">
<span class="sig-name descname"><span class="pre">num_records_loaded</span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.num_records_loaded" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of records written to the target table.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int, default=0</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.error_message">
<span class="sig-name descname"><span class="pre">error_message</span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.error_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Error message describing whichever error that occurred.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str, default=””</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.error_details">
<span class="sig-name descname"><span class="pre">error_details</span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject.error_details" title="Permalink to this definition">¶</a></dt>
<dd><p>Detailed error message or stack trace for the above error.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str, default=””</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.RunStatus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RunStatus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.RunStatus" title="Permalink to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.RunStatus.FAILED">
<span class="sig-name descname"><span class="pre">FAILED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'FAILED'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.RunStatus.FAILED" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a failed run status.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.RunStatus.SUCCEEDED">
<span class="sig-name descname"><span class="pre">SUCCEEDED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'SUCCEEDED'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.RunStatus.SUCCEEDED" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a succeeded run status.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SchemaEvolutionMode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode" title="Permalink to this definition">¶</a></dt>
<dd><p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode.ADD_NEW_COLUMNS">
<span class="sig-name descname"><span class="pre">ADD_NEW_COLUMNS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ADD_NEW_COLUMNS'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode.ADD_NEW_COLUMNS" title="Permalink to this definition">¶</a></dt>
<dd><p>Schema evolution through adding new columns to the target table.
This is the same as using the option “mergeSchema”.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode.FAIL_ON_SCHEMA_MISMATCH">
<span class="sig-name descname"><span class="pre">FAIL_ON_SCHEMA_MISMATCH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'FAIL_ON_SCHEMA_MISMATCH'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode.FAIL_ON_SCHEMA_MISMATCH" title="Permalink to this definition">¶</a></dt>
<dd><p>Fail if the table’s schema is not compatible with the DataFrame’s.
This is the default Spark behavior when no option is given.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode.IGNORE_NEW_COLUMNS">
<span class="sig-name descname"><span class="pre">IGNORE_NEW_COLUMNS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'IGNORE_NEW_COLUMNS'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode.IGNORE_NEW_COLUMNS" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop DataFrame columns that do not exist in the table’s schema.
Does nothing if the table does not yet exist in the Hive metastore.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode.OVERWRITE_SCHEMA">
<span class="sig-name descname"><span class="pre">OVERWRITE_SCHEMA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'OVERWRITE_SCHEMA'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode.OVERWRITE_SCHEMA" title="Permalink to this definition">¶</a></dt>
<dd><p>Overwrite the table’s schema with the DataFrame’s schema.
This is the same as using the option “overwriteSchema”.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode.RESCUE_NEW_COLUMNS">
<span class="sig-name descname"><span class="pre">RESCUE_NEW_COLUMNS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'RESCUE_NEW_COLUMNS'</span></em><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode.RESCUE_NEW_COLUMNS" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new struct-type column to collect data for new columns.
This is the same strategy used in AutoLoader’s rescue mode.
For more information: <a class="reference external" href="https://docs.databricks.com/spark/latest/structured-streaming/auto-loader-schema.html#schema-evolution">https://docs.databricks.com/spark/latest/structured-streaming/auto-loader-schema.html#schema-evolution</a> .</p>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p><strong>ATTENTION</strong>: not implemented yet!</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.clean_column_names">
<span class="sig-name descname"><span class="pre">clean_column_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">except_for</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.clean_column_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the name of all the columns in a given DataFrame.</p>
<p>Uses BrewDat’s standard approach as seen in other Notebooks.
Improved to also trim (strip) whitespaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – The PySpark DataFrame to modify.</p></li>
<li><p><strong>except_for</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default=</em><em>[</em><em>]</em>) – A list of column names that should NOT be modified.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The modified PySpark DataFrame with renamed columns.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.create_or_replace_audit_columns">
<span class="sig-name descname"><span class="pre">create_or_replace_audit_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.create_or_replace_audit_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Create or replace BrewDat audit columns in the given DataFrame.</p>
<dl class="simple">
<dt>The following audit columns are created/replaced:</dt><dd><p>_insert_gmt_ts: timestamp of when the record was inserted.
_update_gmt_ts: timestamp of when the record was last updated.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>DataFrame</em>) – The PySpark DataFrame to modify.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The modified PySpark DataFrame with audit columns.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.create_or_replace_business_key_column">
<span class="sig-name descname"><span class="pre">create_or_replace_business_key_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">business_key_column_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'__'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.create_or_replace_business_key_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a standard business key concatenating multiple columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – The PySpark DataFrame to modify.</p></li>
<li><p><strong>business_key_column_name</strong> (<em>str</em>) – The name of the concatenated business key column.</p></li>
<li><p><strong>key_columns</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – The names of the columns used to uniquely identify each record the table.</p></li>
<li><p><strong>separator</strong> (<em>str</em><em>, </em><em>default=&quot;__&quot;</em>) – A string to separate the values of each column in the business key.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The PySpark DataFrame with the desired business key.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.deduplicate_records">
<span class="sig-name descname"><span class="pre">deduplicate_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">watermark_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.deduplicate_records" title="Permalink to this definition">¶</a></dt>
<dd><p>Deduplicate rows from a DataFrame using key and watermark columns.</p>
<p>We do not use orderBy followed by dropDuplicates because it
would require a coalesce(1) to preserve the order of the rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – The PySpark DataFrame to modify.</p></li>
<li><p><strong>key_columns</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – The names of the columns used to uniquely identify each record the table.</p></li>
<li><p><strong>watermark_column</strong> (<em>str</em>) – The name of a datetime column used to select the newest records.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The deduplicated PySpark DataFrame.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.drop_empty_columns">
<span class="sig-name descname"><span class="pre">drop_empty_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">except_for</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.drop_empty_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop columns which are null or empty for all the rows in the DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – The PySpark DataFrame to modify.</p></li>
<li><p><strong>except_for</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default=</em><em>[</em><em>]</em>) – A list of column names that should NOT be dropped.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The modified PySpark DataFrame.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.exit_with_last_exception">
<span class="sig-name descname"><span class="pre">exit_with_last_exception</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.exit_with_last_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle the last unhandled exception, returning an object to the notebook’s caller.</p>
<p>The most recent exception is obtained from sys.exc_info().</p>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<dl class="simple">
<dt>try:</dt><dd><p># some code</p>
</dd>
<dt>except:</dt><dd><p>BrewDatLibrary.exit_with_last_exception()</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.exit_with_object">
<span class="sig-name descname"><span class="pre">exit_with_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject" title="brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject"><span class="pre">brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.exit_with_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Finish execution returning an object to the notebook’s caller.</p>
<p>Used to return the results of a write operation to the orchestrator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>results</strong> (<a class="reference internal" href="#brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject" title="brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject"><em>ReturnObject</em></a>) – Object containing the results of a write operation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.generate_bronze_table_location">
<span class="sig-name descname"><span class="pre">generate_bronze_table_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_zone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_business_domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_system_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.generate_bronze_table_location" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the standard location for a Bronze table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_zone</strong> (<em>str</em>) – Zone of the target dataset.</p></li>
<li><p><strong>target_business_domain</strong> (<em>str</em>) – Business domain of the target dataset.</p></li>
<li><p><strong>target_system_name</strong> (<em>str</em>) – Name of the source system.</p></li>
<li><p><strong>table_name</strong> (<em>str</em>) – Name of the target table in the metastore.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Standard location for the delta table.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.generate_gold_table_location">
<span class="sig-name descname"><span class="pre">generate_gold_table_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_zone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_business_domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.generate_gold_table_location" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the standard location for a Gold table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_zone</strong> (<em>str</em>) – Zone of the target dataset.</p></li>
<li><p><strong>target_business_domain</strong> (<em>str</em>) – Business domain of the target dataset.</p></li>
<li><p><strong>project</strong> (<em>str</em>) – Project of the target dataset.</p></li>
<li><p><strong>database_name</strong> (<em>str</em>) – Name of the target database for the table in the metastore.</p></li>
<li><p><strong>table_name</strong> (<em>str</em>) – Name of the target table in the metastore.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Standard location for the delta table.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.generate_silver_table_location">
<span class="sig-name descname"><span class="pre">generate_silver_table_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_zone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_business_domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_system_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.generate_silver_table_location" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the standard location for a Silver table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_zone</strong> (<em>str</em>) – Zone of the target dataset.</p></li>
<li><p><strong>target_business_domain</strong> (<em>str</em>) – Business domain of the target dataset.</p></li>
<li><p><strong>target_system_name</strong> (<em>str</em>) – Name of the source system.</p></li>
<li><p><strong>table_name</strong> (<em>str</em>) – Name of the target table in the metastore.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Standard location for the delta table.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.read_raw_dataframe">
<span class="sig-name descname"><span class="pre">read_raw_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat" title="brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat"><span class="pre">brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.read_raw_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a DataFrame from the Raw Layer. Convert all data types to string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_format</strong> (<a class="reference internal" href="#brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat" title="brewdat.data_engineering.utils.BrewDatLibrary.RawFileFormat"><em>RawFileFormat</em></a>) – The raw file format use in this dataset (CSV, PARQUET, etc.).</p></li>
<li><p><strong>location</strong> (<em>str</em>) – Absolute Data Lake path for the physical location of this dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The PySpark DataFrame read from the Raw Layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brewdat.data_engineering.utils.BrewDatLibrary.write_delta_table">
<span class="sig-name descname"><span class="pre">write_delta_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pyspark.sql.dataframe.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#brewdat.data_engineering.utils.BrewDatLibrary.LoadType" title="brewdat.data_engineering.utils.BrewDatLibrary.LoadType"><span class="pre">brewdat.data_engineering.utils.BrewDatLibrary.LoadType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema_evolution_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode" title="brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode"><span class="pre">brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">SchemaEvolutionMode.ADD_NEW_COLUMNS</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject" title="brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject"><span class="pre">brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject</span></a></span></span><a class="headerlink" href="#brewdat.data_engineering.utils.BrewDatLibrary.write_delta_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the DataFrame as a delta table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – PySpark DataFrame to modify.</p></li>
<li><p><strong>location</strong> (<em>str</em>) – Absolute Delta Lake path for the physical location of this delta table.</p></li>
<li><p><strong>schema_name</strong> (<em>str</em>) – Name of the schema/database for the table in the metastore.
Schema is created if it does not exist.</p></li>
<li><p><strong>table_name</strong> (<em>str</em>) – Name of the table in the metastore.</p></li>
<li><p><strong>load_type</strong> (<a class="reference internal" href="#brewdat.data_engineering.utils.BrewDatLibrary.LoadType" title="brewdat.data_engineering.utils.BrewDatLibrary.LoadType"><em>BrewDatLibrary.LoadType</em></a>) – Specifies the way in which the table should be loaded.</p></li>
<li><p><strong>key_columns</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default=</em><em>[</em><em>]</em>) – The names of the columns used to uniquely identify each record the table.
Used for APPEND_NEW, UPSERT, and TYPE_2_SCD load types.</p></li>
<li><p><strong>partition_columns</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default=</em><em>[</em><em>]</em>) – The names of the columns used to partition the table.</p></li>
<li><p><strong>schema_evolution_mode</strong> (<a class="reference internal" href="#brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode" title="brewdat.data_engineering.utils.BrewDatLibrary.SchemaEvolutionMode"><em>BrewDatLibrary.SchemaEvolutionMode</em></a><em>, </em><em>default=ADD_NEW_COLUMNS</em>) – Specifies the way in which schema mismatches should be handled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Object containing the results of a write operation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject" title="brewdat.data_engineering.utils.BrewDatLibrary.ReturnObject">ReturnObject</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">brewdat-pltfrm-ghq-tech-template-adb</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, BrewDat.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>